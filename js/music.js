var music=[{id:"6787417362",type:"playlist",server:"netease"},{id:"5279950644",type:"playlist",server:"netease"},{id:"12400563817",type:"playlist",server:"netease"},{id:"5321409260",type:"playlist",server:"netease"},{id:"6986639455",type:"playlist",server:"netease"},{id:"7735981148",type:"playlist",server:"netease"},{id:"8829414068",type:"playlist",server:"netease"},{id:"7017408987",type:"playlist",server:"netease"},{id:"7666409008",type:"playlist",server:"netease"},{id:"8712166945",type:"playlist",server:"netease"},{id:"7397995017",type:"playlist",server:"tencent"}];const defaultMusic={id:"7397995017",type:"playlist",server:"tencent"};let localMusic=JSON.parse(localStorage.getItem("localMusic"))||defaultMusic;localStorage.getItem("defaultMusic")||localStorage.setItem("defaultMusic",JSON.stringify(defaultMusic)),localStorage.getItem("localMusic")||localStorage.setItem("localMusic",JSON.stringify(localMusic));let musicVolume=.8;const muxiaochen={changeMusicBg:function(e=!0){if("/life/music/"!==window.location.pathname)return;const t=document.getElementById("an_music_bg");if(e){const e=document.querySelector("#anMusic-page .aplayer-pic");t.style.backgroundImage=e.style.backgroundImage}else{let e=setInterval((()=>{const a=document.querySelector("#anMusic-page .aplayer-pic");a&&(clearInterval(e),t.style.backgroundImage=a.style.backgroundImage,muxiaochen.addEventListenerMusic(),muxiaochen.changeMusicBg())}),100)}},addEventListenerMusic:function(){const e=document.getElementById("anMusic-page"),t=e.querySelector(".aplayer-info .aplayer-time .aplayer-icon-menu"),a=e.querySelector("#anMusicBtnGetSong"),i=e.querySelector("#anMusicRefreshBtn"),s=e.querySelector("#anMusicSwitching"),c=window.aplayers[0];c.volume(.8,!0),c.on("loadeddata",(function(){muxiaochen.changeMusicBg()})),t.addEventListener("click",(function(){document.getElementById("menu-mask").style.display="block",document.getElementById("menu-mask").style.animation="0.5s ease 0s 1 normal none running to_show",e.querySelector(".aplayer.aplayer-withlist .aplayer-list").style.opacity="1"})),document.getElementById("menu-mask").addEventListener("click",(function t(){"/life/music/"===window.location.pathname?e.querySelector(".aplayer-list").classList.remove("aplayer-list-hide"):document.getElementById("menu-mask").removeEventListener("click",t)})),a.addEventListener("click",(()=>{const e=window.aplayers[0],t=e.list.audios,a=Math.floor(Math.random()*t.length);e.list.switch(a)})),i.addEventListener("click",(()=>{muxiaochen.refreshMusicList()})),s.addEventListener("click",(()=>{muxiaochen.changeMusicList()})),document.addEventListener("keydown",(function(e){"Space"===e.code&&(e.preventDefault(),c.toggle()),39===e.keyCode&&(e.preventDefault(),c.skipForward()),37===e.keyCode&&(e.preventDefault(),c.skipBack()),38===e.keyCode&&musicVolume<=1&&(musicVolume+=.1,c.volume(musicVolume,!0)),40===e.keyCode&&musicVolume>=0&&(musicVolume+=-.1,c.volume(musicVolume,!0))}))},refreshMusicList:async function(){const e=window.aplayers[0];let t=[];localMusic=defaultMusic,localStorage.setItem("localMusic",JSON.stringify(defaultMusic));let a=`https://twikoo.aimiliy.top/music/api?server=${localMusic.server}&type=${localMusic.type}&id=${localMusic.id}&auth=undefined&r=${Math.random()*Date.now()}`;t=await muxiaochen.fetchSongs(a),t.length>0&&(e.list.clear(),e.list.add(t))},changeMusicList:async function(){const e=window.aplayers[0];let t=[],a=Math.floor(Math.random()*music.length);for(;JSON.parse(localStorage.getItem("localMusic")).id===music[a].id;)a=Math.floor(Math.random()*music.length);localMusic=music[a],localStorage.setItem("localMusic",JSON.stringify(music[a]));let i=`https://twikoo.aimiliy.top/music/api?server=${music[a].server}&type=${music[a].type}&id=${music[a].id}&auth=undefined&r=${Math.random()*Date.now()}`;t=await muxiaochen.fetchSongs(i),t.length>0&&(e.list.clear(),e.list.add(t))},async fetchSongs(e){let t=[];try{const a=await fetch(e);a.ok||(t=[]),t=await a.json()}catch(e){console.error("获取歌曲时出错:",e.message),t=[]}return t}};document.addEventListener("DOMContentLoaded",(()=>{muxiaochen.changeMusicBg(!1)})),muxiaochen.changeMusicBg(!1);