(()=>{const e={debounce:(e,t=0,n=!1)=>{let o;return(...i)=>{const s=n&&!o;clearTimeout(o),o=setTimeout((()=>{o=null,n||e(...i)}),t),s&&e(...i)}},throttle:function(e,t,n={}){let o,i,s,a=0;const r=()=>{a=!1===n.leading?0:(new Date).getTime(),o=null,e.apply(i,s),o||(i=s=null)};return(...l)=>{const d=(new Date).getTime();a||!1!==n.leading||(a=d);const c=t-(d-a);i=this,s=l,c<=0||c>t?(o&&(clearTimeout(o),o=null),a=d,e.apply(i,s),o||(i=s=null)):o||!1===n.trailing||(o=setTimeout(r,c))}},addEventListenerPjax:(e,t,n,o=!1)=>{t instanceof NodeList?t.forEach((t=>{t.addEventListener(e,n,o),btf.addGlobalFn("pjaxSendOnce",(()=>{t.removeEventListener(e,n,o)}))})):(t.addEventListener(e,n,o),btf.addGlobalFn("pjaxSendOnce",(()=>{t.removeEventListener(e,n,o)})))},runIdle:(e,t=0)=>"requestIdleCallback"in window?requestIdleCallback(e,{timeout:t}):setTimeout(e,t),cancelIdle:e=>{"cancelIdleCallback"in window?cancelIdleCallback(e):clearTimeout(e)},removeGlobalFnEvent:(e,t=window)=>{const n=t.globalFn||{},o=n[e];o&&(Object.keys(o).forEach((e=>o[e]())),delete n[e])},overflowPaddingR:{add:()=>{const e=window.innerWidth-document.body.clientWidth;if(e>0){document.body.style.paddingRight=`${e}px`,document.body.style.overflow="hidden";const t=document.querySelector("#page-header.nav-fixed #menus");t&&(t.style.paddingRight=`${e}px`)}},remove:()=>{document.body.style.paddingRight="",document.body.style.overflow="";const e=document.querySelector("#page-header.nav-fixed #menus");e&&(e.style.paddingRight="")}},diffDate:(e,t=!1)=>{const n=new Date,o=new Date(e),i=(n-o)/1e3/60,s=i/60,a=s/24,r=a/30,{dateSuffix:l}=GLOBAL_CONFIG;return t?r>12?o.toISOString().slice(0,10):r>=1?`${Math.floor(r)} ${l.month}`:a>=1?`${Math.floor(a)} ${l.day}`:s>=1?`${Math.floor(s)} ${l.hour}`:i>=1?`${Math.floor(i)} ${l.min}`:l.just:Math.floor(a)},loadComment:(e,t)=>{if("IntersectionObserver"in window){const n=new IntersectionObserver((e=>{e[0].isIntersecting&&(t(),n.disconnect())}),{threshold:[0]});n.observe(e)}else t()},scrollToDest:(e,t=500)=>{const n=window.scrollY;if(n>e&&(e-=70),"scrollBehavior"in document.documentElement.style)return void window.scrollTo({top:e,behavior:"smooth"});const o=performance.now(),i=s=>{const a=s-o,r=Math.min(a/t,1);window.scrollTo(0,n+(e-n)*r),r<1&&requestAnimationFrame(i)};requestAnimationFrame(i)},animateIn:(e,t)=>{e.style.display="block",e.style.animation=t},animateOut:(e,t)=>{const n=()=>{e.style.display="",e.style.animation="",e.removeEventListener("animationend",n)};e.addEventListener("animationend",n),e.style.animation=t},siblings:(e,t)=>[...e.parentNode.children].filter((n=>t?n!==e&&n.matches(t):n!==e)),wrap:(e,t,n)=>{const o=document.createElement(t);for(const[e,t]of Object.entries(n))o.setAttribute(e,t);e.parentNode.insertBefore(o,e),o.appendChild(e)},isHidden:e=>0===e.offsetHeight&&0===e.offsetWidth,getEleTop:e=>{let t=e.offsetTop,n=e.offsetParent;for(;null!==n;)t+=n.offsetTop,n=n.offsetParent;return t},loadLightbox:e=>{const t=GLOBAL_CONFIG.lightbox;if("medium_zoom"!==t){if("fancybox"===t&&(Array.from(e).forEach((e=>{if("A"!==e.parentNode.tagName){const t=e.dataset.lazySrc||e.src,n=e.title||e.alt||"";btf.wrap(e,"a",{href:t,"data-fancybox":"gallery","data-caption":n,"data-thumb":t})}})),!window.fancyboxRun)){let e="";e=Fancybox.version<"6"?{Hash:!1,Thumbs:{showOnStart:!1},Images:{Panzoom:{maxScale:4}},Carousel:{transition:"slide"},Toolbar:{display:{left:["infobar"],middle:["zoomIn","zoomOut","toggle1to1","rotateCCW","rotateCW","flipX","flipY"],right:["slideshow","thumbs","close"]}}}:{Hash:!1,Carousel:{transition:"slide",Thumbs:{showOnStart:!1},Toolbar:{display:{left:["counter"],middle:["zoomIn","zoomOut","toggle1to1","rotateCCW","rotateCW","flipX","flipY","reset"],right:["autoplay","thumbs","close"]}},Zoomable:{Panzoom:{maxScale:4}}}},Fancybox.bind("[data-fancybox]",e),window.fancyboxRun=!0}}else mediumZoom(e,{background:"var(--zoom-bg)"})},setLoading:{add:e=>{e.insertAdjacentHTML("afterend",'\n        <div class="loading-container">\n          <div class="loading-item">\n            <div></div><div></div><div></div><div></div><div></div>\n          </div>\n        </div>\n      ')},remove:e=>{e.nextElementSibling.remove()}},setMusicLoading:{add:e=>{e.insertAdjacentHTML("afterend",'<div class="loader" style="position: fixed;width: 120px;height: 120px;top: 50%;left: 50%;transform: translate(-50%, -50%);">\n                                          <div class="music-note">\n                                            <svg viewBox="0 0 64 64" width="50" height="50" xmlns="http://www.w3.org/2000/svg">\n                                              <defs>\n                                                <linearGradient id="gradient" x1="0" y1="0" x2="1" y2="1">\n                                                  <stop offset="0%" stop-color="#bb86fc"/>\n                                                  <stop offset="100%" stop-color="#6200ee"/>\n                                                </linearGradient>\n                                              </defs>\n                                              <path d="M22 14v29a8 8 0 1 0 4-6.9V12h10v6l8-3v-7H22z"/>\n                                            </svg>\n                                          </div>\n                                        \n                                          <div class="pulse-ring"></div>\n                                          <div class="pulse-ring"></div>\n                                          <div class="pulse-ring"></div>\n                                        \n                                          <div class="spectrum">\n                                            <div class="bar"></div>\n                                            <div class="bar"></div>\n                                            <div class="bar"></div>\n                                            <div class="bar"></div>\n                                            <div class="bar"></div>\n                                          </div>\n                                        </div>')},remove:e=>{e.nextElementSibling.remove()}},setLocLoading:{add:e=>{e.insertAdjacentHTML("afterend",'<div style="display: flex;justify-content: center;align-items: center;position:relative;height:150px;width: 100%"><div class="loading-spinner glow"></div></div>')},remove:e=>{e.nextElementSibling.remove()}},updateAnchor:e=>{if(e!==window.location.hash){e||(e=location.pathname);const t=GLOBAL_CONFIG_SITE.title;window.history.replaceState({url:location.href,title:t},t,e)}},getScrollPercent:(()=>{let e,t,n,o;return(i,s)=>{e&&s.clientHeight===e||(e=s.clientHeight,t=window.innerHeight,n=s.offsetTop,o=Math.max(e-t,document.documentElement.scrollHeight-t));const a=(i-n)/o;return Math.max(0,Math.min(100,Math.round(100*a)))}})(),linkCom:e=>{const t=document.querySelector(".el-textarea__inner");"bf"===e?(t.value="- name: \n  link: \n  avatar: \n  descr: \n  siteshot: ",t.setSelectionRange(7,7)):(t.value="ç«™ç‚¹åç§°ï¼š\nç«™ç‚¹åœ°å€ï¼š\nå¤´åƒé“¾æŽ¥ï¼š\nç«™ç‚¹æè¿°ï¼š\nç«™ç‚¹æˆªå›¾ï¼š",t.setSelectionRange(5,5)),t.focus()},$notify:(e,t,n,o=5e3)=>{const i=()=>{const{wrapper:i,closeButton:s}=(()=>{const i=document.createElement("div");i.style.padding="16px 25px";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="12px";const a=document.createElement("div");a.style.display="flex",a.style.alignItems="center",a.style.gap="12px";const r=document.createElement("i");r.className={success:"fas fa-check-circle",error:"fas fa-times-circle",warning:"fas fa-exclamation-circle"}[n]||"fas fa-check-circle",r.style.color="var(--theme-color)",r.style.fontSize="20px";const l=document.createElement("div");l.textContent=e,l.style.fontWeight="600",l.style.fontSize="17px",l.style.color="#2d3436",l.style.letterSpacing="0.3px",a.appendChild(r),a.appendChild(l);const d=document.createElement("div");d.innerHTML="<i class='fas fa-times'></i>",d.style.cursor="pointer",d.style.padding="4px",d.style.borderRadius="50%",d.style.transition="all 0.2s",d.style.color="var(--theme-color)",d.style.fontSize="16px",s.appendChild(a),s.appendChild(d);const c=document.createElement("div");c.textContent=t,c.style.fontSize="15px",c.style.lineHeight="1.5",c.style.color="#495057",c.style.paddingLeft="32px";const h=document.createElement("div");return h.style.height="3px",h.style.background="var(--theme-color)",h.style.position="absolute",h.style.bottom="0",h.style.left="0",h.style.width="100%",h.style.animation=`progressToast ${o}ms linear 1 forwards`,i.appendChild(s),i.appendChild(c),i.appendChild(h),{wrapper:i,closeButton:d}})(),a=Toastify({text:"",duration:o,gravity:"top",position:"left",stopOnFocus:!1,style:{width:"auto",padding:"0",borderRadius:"8px",textAlign:"left",boxShadow:"0 3px 7px 0 rgba(0, 0, 0, .25)",background:"linear-gradient(145deg, #ffffff, #f8f9fa)",color:"#2d3436",maxWidth:"300px",border:"1px solid rgba(0, 0, 0, 0.08)",overflow:"hidden",backdropFilter:"blur(4px)"},node:i});s.addEventListener("click",(()=>{a.hideToast()})),a.showToast()};"function"==typeof Toastify?i():getScript(`${GLOBAL_CONFIG.toast.js}`).then(i)},snowflake:()=>{/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i.test(navigator.userAgent)||"block"!==localStorage.getItem("snow")||"light"!==document.documentElement.getAttribute("data-theme")||window&&(()=>{const e=(e,n,o,i,s,a,r)=>{const l=2*Math.PI/6;e.save(),e.translate(n,o),e.rotate(r),e.strokeStyle="rgba("+s+", "+a+")",e.lineWidth=.05*i;for(let n=0;n<6;n++)e.rotate(l),t(e,i);e.restore()},t=(e,t)=>{const n=1.3*t,o=.4*n,i=Math.PI/6;e.beginPath(),e.moveTo(0,0),e.lineTo(0,-n),e.stroke();for(let t=1;t<=6;t++){const s=n/7*t,a=Math.PI/16;e.beginPath(),e.moveTo(0,-s),e.lineTo(-o*Math.sin(i+a*t),-s-o*Math.cos(i+a*t)),e.stroke(),e.beginPath(),e.moveTo(0,-s),e.lineTo(o*Math.sin(i-a*t),-s-o*Math.cos(i-a*t)),e.stroke(),t%2==0&&(e.beginPath(),e.moveTo(o*Math.sin(i-a*t),-s-o*Math.cos(i-a*t)),e.lineTo(1.2*o*Math.sin(i-a*t+Math.PI/12),-s-1.2*o*Math.cos(i-a*t+Math.PI/12)),e.stroke())}const s=.2*n;for(let t=1;t<=4;t++){const o=n/5*t,a=Math.PI/20;e.beginPath(),e.moveTo(0,-o),e.lineTo(s*Math.sin(i+a*t),-o-s*Math.cos(i+a*t)),e.stroke(),e.beginPath(),e.moveTo(0,-o),e.lineTo(-s*Math.sin(i-a*t),-o-s*Math.cos(i-a*t)),e.stroke()}},n=(e,t,n,i,s,a,r)=>{const l=2*Math.PI/6;e.save(),e.translate(t,n),e.rotate(r),e.strokeStyle="rgba("+s+", "+a+")",e.lineWidth=.05*i;for(let t=0;t<6;t++)e.rotate(l),o(e,i);e.restore()},o=(e,t)=>{const n=1.3*t,o=Math.PI/6;e.beginPath(),e.moveTo(0,0),e.lineTo(0,-n),e.stroke();for(let t=1;t<=10;t++){const i=n/11*t,s=o+.1*t;e.beginPath(),e.moveTo(0,-i),e.lineTo(-i*Math.sin(s),-i-i*Math.cos(s)),e.stroke(),e.beginPath(),e.moveTo(0,-i),e.lineTo(i*Math.sin(s),-i-i*Math.cos(s)),e.stroke()}const i=.2*n;for(let t=1;t<=4;t++){const s=n/5*t,a=o+.1*t*1.5;e.beginPath(),e.moveTo(0,-s),e.lineTo(i*Math.sin(a),-s-i*Math.cos(a)),e.stroke(),e.beginPath(),e.moveTo(0,-s),e.lineTo(-i*Math.sin(a),-s-i*Math.cos(a)),e.stroke()}},i=(e,t,n,o,i,a,r)=>{const l=2*Math.PI/6;e.save(),e.translate(t,n),e.rotate(r),e.strokeStyle="rgba("+i+", "+a+")",e.lineWidth=.05*o;for(let t=0;t<6;t++)e.rotate(l),s(e,o);e.restore()},s=(e,t)=>{const n=1.2*t;e.beginPath(),e.moveTo(0,0),e.lineTo(0,-n),e.stroke(),a(e,n,0)},a=(e,t,n)=>{if(n>2)return;const o=.6*t,i=Math.PI/6;for(let s=0;s<3;s++){const r=i*(s-1);e.beginPath(),e.moveTo(0,-t),e.lineTo(o*Math.sin(r),-t-o*Math.cos(r)),e.stroke(),a(e,o,n+1)}},r={flakeCount:50,minDist:150,color:"255, 255, 255",size:6,speed:.5,opacity:.6,stepsize:.5,rotation:2*Math.PI,rotationSpeed:.02,snowflakeMethod:e},l=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,d=document.getElementById("snow"),c=d.getContext("2d"),h=r.flakeCount;let m=-100,u=-100,f=[];d.width=window.innerWidth,d.height=window.innerHeight;const p=()=>{if(!btf.snowRunning)return;c.clearRect(0,0,d.width,d.height);const e=r.minDist;for(let t=0;t<h;t++){let n=f[t];const o=m,i=u,s=n.x,a=n.y,l=Math.sqrt((o-s)*(o-s)+(i-a)*(i-a));if(l<e){const t=(o-s)/l,r=(i-a)/l,d=e/(l*l)/2;n.velX-=d*t,n.velY-=d*r}else n.velX*=.98,n.velY<n.speed&&n.speed-n.velY>.01&&(n.velY+=.01*(n.speed-n.velY)),n.velX+=Math.cos(n.step+=.05)*n.stepSize;n.rotation+=n.rotationSpeed,n.y+=n.velY,n.x+=n.velX,(n.y>=d.height||n.y<=0)&&(n.opacity-=.02,n.opacity<=0&&v(n)),(n.x>=d.width||n.x<=0)&&(n.opacity-=.02,n.opacity<=0&&v(n)),n.snowflakeMethod(c,n.x,n.y,n.size,r.color,n.opacity,n.rotation)}btf.snowId=l(p)},v=t=>{t.x=Math.floor(Math.random()*d.width),t.y=0,t.size=4*Math.random()+r.size,t.speed=Math.random()+r.speed,t.velY=t.speed,t.velX=0,t.opacity=.6*Math.random()+r.opacity,t.rotation=Math.random()*r.rotation,t.rotationSpeed=(Math.random()-.5)*r.rotationSpeed,t.snowflakeMethod=(()=>{const t=[e,n,i];return t[Math.floor(Math.random()*t.length)]})()};btf.addGlobalListener("mousemove",document,(e=>{m=e.clientX,u=e.clientY}),"snowMouseMove");const g=btf.throttle((()=>{d.width=window.innerWidth,d.height=window.innerHeight}),200);btf.addGlobalListener("resize",window,g,"snowResize");for(let e=0;e<h;e++)f.push({speed:Math.random()+r.speed,velX:0,velY:Math.random()+r.speed,x:Math.floor(Math.random()*d.width),y:Math.floor(Math.random()*d.height),size:4*Math.random()+r.size,stepSize:Math.random()/30*r.stepsize,step:0,angle:180,opacity:.6*Math.random()+r.opacity,rotation:Math.random()*r.rotation,rotationSpeed:(Math.random()-.5)*r.rotationSpeed,snowflakeMethod:r.snowflakeMethod});btf.snowRunning=!0,p()})()},dark:()=>{const e=/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i.test(navigator.userAgent);if("dark"===document.documentElement.getAttribute("data-theme")&&"block"===localStorage.getItem("universe")&&!(e||document.body.clientWidth<800)){const a=window.requestAnimationFrame,r=document.getElementById("universe"),l=r.getContext("2d");let d,c,h,m=[],u=!0;const f=.05,p="180,184,240",v="226,225,142",g="226,225,224",y=2*Math.PI;let b,w=120;function t(){d=window.innerWidth,c=window.innerHeight;const e=(navigator.hardwareConcurrency||4)<=4,t=Math.floor(.216*d);h=e?80:Math.min(t,250),r.width=d,r.height=c,w=Math.max(80,Math.floor(.06*Math.min(d,c)))}function n(){this.reset=function(){this.giant=o(3),this.comet=!this.giant&&!u&&o(10),this.x=i(0,d-10),this.y=i(0,c),this.r=i(1.1,2.6),this.dx=i(f,6*f)+(this.comet?f*i(50,120)+2*f:0),this.dy=-i(f,6*f)-(this.comet?f*i(50,120):0),this.fadingOut=null,this.fadingIn=!0,this.opacity=0,this.opacityTresh=i(.2,this.comet?.6:1),this.do=i(5e-4,.002)+(this.comet?.001:0)},this.fadeIn=function(){this.fadingIn&&(this.fadingIn=!(this.opacity>this.opacityTresh),this.opacity+=this.do)},this.fadeOut=function(){this.fadingOut&&(this.fadingOut=!(this.opacity<0),this.opacity-=this.do/2,(this.x>d||this.y<0)&&(this.fadingOut=!1,this.reset()))},this.draw=function(e){if(e.beginPath(),this.giant)e.fillStyle=`rgba(${p},${this.opacity})`,e.arc(this.x,this.y,2,0,y),e.fill();else if(this.comet){e.fillStyle=`rgba(${g},${this.opacity})`,e.arc(this.x,this.y,1.5,0,y),e.fill();let t=this.opacity/20;for(let n=0;n<10;n++)e.fillStyle=`rgba(${g},${Math.max(0,this.opacity-t*n)})`,e.fillRect(this.x-this.dx/4*n,this.y-this.dy/4*n-2,2,2)}else e.fillStyle=`rgba(${v},${this.opacity})`,e.fillRect(this.x,this.y,this.r,this.r);e.closePath()},this.move=function(){this.x+=this.dx,this.y+=this.dy,!1===this.fadingOut&&this.reset(),(this.x>d-d/4||this.y<0)&&(this.fadingOut=!0)},setTimeout((()=>{u=!1}),50)}function o(e){return 1e3*Math.random()<10*e}function i(e,t){return Math.random()*(t-e)+e}t(),btf.addGlobalListener("resize",window,(function(){btf.universeRunning=!1,clearTimeout(b),b=setTimeout((()=>{t(),btf.universeRunning=!0,s()}),300)}),"resizef");for(let M=0;M<h;M++)m[M]=new n,m[M].reset();function s(){btf.universeRunning&&(!function(){let e;l.clearRect(0,0,d,c);for(let t=0,n=m.length;t<n;t++)e=m[t],e.move(),e.x>=-w&&e.x<=d+w&&e.y>=-w&&e.y<=c+w?(e.fadeIn(),e.fadeOut(),e.draw(l)):(e.x>d+5*w||e.y<5*-w||e.x<5*-w||e.y>c+5*w)&&e.reset()}(),btf.universeId=a(s))}btf.universeRunning=!0,s()}},clearCanvas:(e,t)=>{btf[t]&&(cancelAnimationFrame(btf[t]),btf[t]=null);const n=document.getElementById(e);if(n&&n.getContext){n.getContext("2d").clearRect(0,0,n.width,n.height)}},checkWidth:()=>{(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=800?(btf.clearCanvas("snow","snowId"),btf.clearCanvas("universe","universeId"),btf.removeGlobalListener("snowMouseMove"),btf.removeGlobalListener("snowResize"),btf.removeGlobalListener("resizef")):"light"===document.documentElement.getAttribute("data-theme")?btf.snowflake():btf.dark()},removeGlobalListener:e=>{if(window.eventMap.has(e)){const{event:t,selector:n,callback:o,option:i}=window.eventMap.get(e);n instanceof NodeList?n.forEach((e=>{e.removeEventListener(t,o,i)})):n.removeEventListener(t,o,i),window.eventMap.delete(e)}},addGlobalListener:(window.eventMap=window.eventMap||new Map,(e,t,n,o,i=!1)=>{btf.removeGlobalListener(o),t instanceof NodeList?t.forEach((t=>{t.addEventListener(e,n,i)})):t.addEventListener(e,n,i),window.eventMap.set(o,{event:e,selector:t,callback:n,option:i})}),currentVersion:"v2.71",universeId:null,snowId:null,snowRunning:!1,universeRunning:!1,FpsMonitor:(()=>{const e=[{max:5,desc:"å¡æˆpptðŸ¤¢",color:"#bd0000"},{max:15,desc:"ç”µç«žçº§å¸§çŽ‡ðŸ˜–",color:"red"},{max:25,desc:"æœ‰ç‚¹éš¾å—ðŸ˜¨",color:"orange"},{max:35,desc:"ä¸å¤ªæµç•…ðŸ™„",color:"#9338e6"},{max:45,desc:"è¿˜ä¸é”™å“¦ðŸ˜",color:"#08b7e4"},{max:1/0,desc:"ååˆ†æµç•…ðŸ¤£",color:"#39c5bb"}],t=[.5,.7,.9,1.2,1.5];return class{constructor(){this.state={frame:0,lastTime:0,lastUpdate:0,rafId:null},this.fpsHistory=new Array(10).fill(60),this.historyIndex=0,this.loop=this.loop.bind(this),this.elementVisible=!0,this.intersectionObserver=null,this.intersectionChangeTimeout=null}init(){this.dom={container:document.getElementById("fps"),num:document.querySelector("#fps .fps-num"),desc:document.querySelector("#fps .fps-des")},this.validateDOM()?this.bindIntersectionObserver():console.warn("[FpsMonitor] DOM åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥ #fps å…ƒç´ æ˜¯å¦å­˜åœ¨")}validateDOM(){return!!this.dom.container&&!!this.dom.num&&!!this.dom.desc}bindIntersectionObserver(){"IntersectionObserver"in window&&(this.intersectionObserver=new IntersectionObserver((e=>{for(const t of e)t.target===this.dom.container&&(this.intersectionChangeTimeout&&clearTimeout(this.intersectionChangeTimeout),this.intersectionChangeTimeout=setTimeout((()=>{this.elementVisible=t.isIntersecting,this.elementVisible?this.resumeLoop():this.cancelLoop()}),100))}),{threshold:.5}),this.intersectionObserver.observe(this.dom.container))}startLoop(){this.state.rafId||(this.state.rafId=requestAnimationFrame(this.loop))}cancelLoop(){this.state.rafId&&(cancelAnimationFrame(this.state.rafId),this.state.rafId=null)}resumeLoop(){this.state.rafId||(this.state.lastTime=performance.now(),this.state.frame=0,this.startLoop())}loop(e){const{state:t}=this;if(t.frame++,e>t.lastTime+1e3){const n=e-t.lastTime,o=Math.round(1e3*t.frame/n);this.addFps(o);const i=this.calculateWeightedFps();e-t.lastUpdate>500&&(this.updateDisplay(i),t.lastUpdate=e),t.frame=0,t.lastTime=e}t.rafId=requestAnimationFrame(this.loop)}addFps(e){this.fpsHistory[this.historyIndex]=e,this.historyIndex=(this.historyIndex+1)%10}calculateWeightedFps(){const e=[];for(let n=0;n<t.length;n++){let t=(this.historyIndex-1-n+10)%10;e.unshift(this.fpsHistory[t])}const n=t.reduce(((e,t)=>e+t),0),o=e.reduce(((e,n,o)=>e+n*t[o]),0);return Math.round(o/n)}updateDisplay(t){const n=e.find((e=>t<=e.max))||e[e.length-1];this.dom.num.textContent=`FPSï¼š${t}`,this.dom.desc.textContent=n.desc,this.dom.desc.style.color=n.color}destroy(){this.cancelLoop(),this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null),this.dom=null,this.intersectionChangeTimeout&&clearTimeout(this.intersectionChangeTimeout)}}})(),replaceAll:(e,t,n)=>e.split(t).join(n),rmf:{showRightMenu:(e,t=0,n=0)=>{const o=document.getElementById("rightMenu");e?(o.style.top=`${t}px`,o.style.left=`${n}px`,o.classList.remove("show-anim"),o.offsetWidth,o.classList.add("show-anim"),o.style.visibility="visible"):(o.classList.remove("show-anim"),o.style.display="none")},copyToClipboard:e=>{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)},copyWordsLink:()=>btf.rmf.copyToClipboard(window.location.href),switchReadMode:()=>{const e=document.body,t=document.createElement("button"),n=()=>{e.classList.remove("read-mode"),t.remove(),t.removeEventListener("click",n,!1)};e.classList.add("read-mode"),t.type="button",t.className="fas fa-sign-out-alt exit-readmode",btf.addGlobalListener("click",t,n,"exitReadMode"),e.appendChild(t)},copySelect:()=>{document.execCommand("Copy")},scrollToTop:()=>{btf.scrollToDest(0,500)},rightMenuCommentText:e=>{const t=document.getElementById("post-comment").offsetTop;window.scrollTo(0,t-80),"undefined"!==e&&"null"!==e||(e="å¥½æ£’ï¼");const n=()=>{setTimeout((()=>{const t=document.querySelector(".el-textarea__inner");t||n();const o=document.createEvent("HTMLEvents");o.initEvent("input",!0,!0);const i=btf.replaceAll(e,"\n","\n> ");t.value=`> ${i}\n\n`,t.dispatchEvent(o),t.focus(),t.setSelectionRange(-1,-1);const s=document.getElementById("comment-tips");s&&s.classList.add("show")}),100)};n()},fullScreen:()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}},switchComments:(e=document,t)=>{const n=e.querySelector("#switch-btn");if(!n)return;let o=!1;const i=e.querySelector("#post-comment");btf.addEventListenerPjax(n,"click",(()=>{i.classList.toggle("move"),o||"function"!=typeof loadOtherComment||(o=!0,loadOtherComment(e,t))}))}};window.btf={...window.btf,...e},Object.assign(window.btf,{currentVersion:e.currentVersion,universeId:e.universeId,snowId:e.snowId,snowRunning:e.snowRunning,universeRunning:e.universeRunning})})();